FROM python:3.12-slim


# Set the working directory inside the container
WORKDIR /app

# Copy the pyproject.toml and uv.lock files
# This allows Docker to cache the dependency installation layer
COPY pyproject.toml uv.lock* ./

# Install dependencies using uv based on your lock file
# --locked ensures exact versions from uv.lock are used
# --all-extras if your project uses optional dependencies defined in pyproject.toml
RUN uv sync --locked --all-extras

# Copy the rest of your application code
COPY . .


ENV KAFKA_HOST="localhost"
ENV KAFKA_PORT="9092"

CMD ["uv", "run"  "uvicorn", "main:app", "--host", "0.0.0.0", "--port", "80"]
